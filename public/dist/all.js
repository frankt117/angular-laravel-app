angular.module("app",["app.manage-admin","app.manage-service-provider","app.manage-customer","app.new-user","app.landing-page","app.main","app.negotiate-page","ui.router","ui.bootstrap","AuthSrvc","app.nav-bar","privileges","app.service-categories","app.markets","app.images","app.packages","app.trims","app.companies","app.negotiation","app.info"]).config(["$stateProvider","$urlRouterProvider",function(e,c){c.otherwise("/index")}]).run(function(){}).controller("AppCtrl",["$scope","$location",function(e){e.loggedIn=sessionStorage.loggedIn}]).directive("semanticCheckbox",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{type:"@",size:"@",checked:"@",model:"=ngModel"},template:'<div class="{{checkbox_class}}"><input type="checkbox"><label ng-click="click_on_checkbox()" ng-transclude></label></div>',link:function(e,c){"standard"==e.type||void 0==e.type?(e.type="standard",e.checkbox_class="ui checkbox"):"slider"==e.type?(e.type="slider",e.checkbox_class="ui slider checkbox"):"toggle"==e.type?(e.type="toggle",e.checkbox_class="ui toggle checkbox"):(e.type="standard",e.checkbox_class="ui checkbox"),"large"==e.size?e.checkbox_class=e.checkbox_class+" large":"huge"==e.size&&(e.checkbox_class=e.checkbox_class+" huge"),"false"==e.checked||void 0==e.checked?e.checked=!1:(e.checked=!0,c.children()[0].setAttribute("checked","")),c.bind("click",function(){e.$apply(function(){1==e.checked?(e.checked=!0,e.model=!1,c.children()[0].removeAttribute("checked")):(e.checked=!0,e.model=!0,c.children()[0].setAttribute("checked","true"))})}),e.$watch("model",function(t){void 0!=t&&(1==t?(e.checked=!0,c.children()[0].setAttribute("checked","true")):(e.checked=!1,c.children()[0].removeAttribute("checked")))})}}});
angular.module("app.checkout",["angularLoad","angularPayments","app.oauth-service"]).directive("paymentForm",function(){return{restrict:"E",templateUrl:"view/checkout/payment-form.html",controller:["$scope","angularLoad","OauthService","$window","$http",function(e,o,t,r,l){this.loaded=!1,this.trim=e.trimTableCtrl.getSelectedTrim(),this.price=this.trim.price,this.userId=this.trim.user_id,e.name="",e.address_line1="",console.log("TRIM"),console.log(this.trim),o.loadScript("https://js.stripe.com/v2/").then(function(){console.log("STRIPE LOADED!!"),r.Stripe.setPublishableKey("pk_test_p129Weylj3u3q3OW6BHO7YH1"),console.log("KEY SET"),e.paymentFormCtrl.loaded=!0}).catch(function(){console.log("STRIPE FAILED")}),e.stripeCallback=function(o,t){if(t.error)console.log("it failed! error: "+t.error.message);else{console.log("success! token: "+t.id),console.log(o);var r={user_id:e.paymentFormCtrl.userId,token:t.id,price:e.paymentFormCtrl.price};l({method:"POST",url:"index.php/api/v1/billing/charge",params:r}).success(function(e){console.log("CHARGED"),console.log(e)}).error(function(){console.log("CHARGE FAILED")})}}}],controllerAs:"paymentFormCtrl"}});
angular.module("app.companies",["app.companies-service"]).directive("companiesNegotiateTable",function(){return{restrict:"E",templateUrl:"view/companies/negotiate-table.html",controller:["$scope","CompaniesService",function(e){this.companies=[];for(var t=0;t<e.trimTableCtrl.trims.length;t++)1==e.trimTableCtrl.trims[t].selected&&this.companies.push(e.trimTableCtrl.trims[t])}],controllerAs:"companiesNegotiateTableCtrl"}});
var login=angular.module("app.companies-service",[]);login.factory("CompaniesService",["$http",function(r){var e={};return e.getAll=function(){var e=r({method:"GET",url:"index.php/api/v1/companies"});return e},e.getAllByPrimaryUserId=function(e){var a={where:[{primary_user_id:e}]},i=r({method:"GET",url:"index.php/api/v1/companies",params:a});return i},e}]);
angular.module("app.info",[]).directive("aboutUs",function(){return{restrict:"E",templateUrl:"view/info/about-us.html",controller:["$scope",function(){}],controllerAs:"aboutUsCtrl"}}).directive("faq",function(){return{restrict:"E",templateUrl:"view/info/faq.html",controller:["$scope",function(){}],controllerAs:"faqCtrl"}}).directive("privacyPolicy",function(){return{restrict:"E",templateUrl:"view/info/privacy-policy.html",controller:["$scope",function(){}],controllerAs:"privacyPolicyCtrl"}}).directive("termsOfService",function(){return{restrict:"E",templateUrl:"view/info/terms-of-service.html",controller:["$scope",function(){}],controllerAs:"termsOfServiceCtrl"}}).directive("contactUs",function(){return{restrict:"E",templateUrl:"view/info/contact-us.html",controller:["$scope",function(){}],controllerAs:"contactUsCtrl"}});
angular.module("app.images",["app.images-service","users","angularFileUpload"]).directive("imageCarousel",function(){return{restrict:"E",templateUrl:"view/images/carousel.html",controller:["$scope","PackagesService","ImagesService",function(e,i,t){this.slides=t.getImageList(),this.show=!1}],controllerAs:"imageCarouselCtrl"}}).directive("imageCarouselUpload",function(){return{restrict:"E",templateUrl:"view/images/carousel-upload.html",controller:["$scope","PackagesService","ImagesService",function(e){this.slidesUploaded=[],this.apply=function(i){e.imageCarouselUploadCtrl.slidesUploaded=i,e.apply()}}],controllerAs:"imageCarouselUploadCtrl"}}).directive("imageEditTable",function(){return{restrict:"E",templateUrl:"view/images/table.html",controller:["$scope","PackagesService","ImagesService",function(e,i,t){this.slidesEdit=[],this.moveUp=function(i){1!=i&&($current=e.imageEditTableCtrl.slidesEdit[i-1],$temp=e.imageEditTableCtrl.slidesEdit[i-2],e.imageEditTableCtrl.slidesEdit[i-2]=$current,e.imageEditTableCtrl.slidesEdit[i-2].sequence=i-1,e.imageEditTableCtrl.slidesEdit[i-1]=$temp,e.imageEditTableCtrl.slidesEdit[i-1].sequence=i)},this.moveDown=function(i){i!=e.imageEditTableCtrl.slidesEdit.length&&($current=e.imageEditTableCtrl.slidesEdit[i-1],$temp=e.imageEditTableCtrl.slidesEdit[i],e.imageEditTableCtrl.slidesEdit[i]=$current,e.imageEditTableCtrl.slidesEdit[i].sequence=i+1,e.imageEditTableCtrl.slidesEdit[i-1]=$temp,e.imageEditTableCtrl.slidesEdit[i-1].sequence=i)},this.remove=function(i){t.deleteImageFromUpdateList(i).success(function(){for(var t=[],l=1,s=0;s<e.imageEditTableCtrl.slidesEdit.length;s++)e.imageEditTableCtrl.slidesEdit[s].sequence!=i.sequence&&(e.imageEditTableCtrl.slidesEdit[s].sequence=l,t.push(e.imageEditTableCtrl.slidesEdit[s]),l+=1);e.imageEditTableCtrl.slidesEdit=t})},this.findImagesInListBySequence=function(e){for(var i=[],t=0;t<this.slidesEdit.length;t++)this.slidesEdit[t].sequence==e&&i.push(this.slidesEdit[t]);return i},this.findLargestSequenceInList=function(){for(var e=0,i=0;i<this.slidesEdit.length;i++)this.slidesEdit[i].sequence>e&&(e=this.slidesEdit[i].sequence);return e},this.sortImageList=function(){console.log("SORTING : "),console.log(this.slidesEdit);var i=[],t=1,l=this.findLargestSequenceInList(),s=this.slidesEdit.length;l>s&&(s=l);for(var a=0;s>a;a++){var r=this.findImagesInListBySequence(a+1);if(console.log(a+" IMAGES ="),console.log(r),r.length>0)for(var n=0;n<r.length;n++){var d={id:r[n].id,description:r[n].description,fromDb:r[n].fromDb,newTitle:r[n].newTitle,path:r[n].path,sequence:r[n].sequence,title:r[n].title};d.sequence=t,i.push(d),t+=1}}console.log("FINAL SORT:"),console.log(i),e.imageEditTableCtrl.slidesEdit=i}}],controllerAs:"imageEditTableCtrl"}}).directive("imageListAndUploader",function(){return{restrict:"E",templateUrl:"view/images/list-and-uploader.html",controller:["$scope","PackagesService","ImagesService",function(e,i,t){this.list={},this.listEmpty=!0,this._currentView="LIST",this.isListEmpty=function(){return this.listEmpty?!0:!1},this.getCurrentView=function(e){return this._currentView==e},this.setCurrentView=function(e){this._currentView=e},t.imageUploaded=function(i){e.imageListAndUploaderCtrl.listEmpty=!1;var t=e.imageEditTableCtrl.slidesEdit.length+1,l={path:"/images/upload/",title:i.file.name,newTitle:"",description:"",sequence:t};e.imageEditTableCtrl.slidesEdit.push(l)}}],controllerAs:"imageListAndUploaderCtrl"}}).directive("imageListAndUploaderUpdate",function(){return{restrict:"E",templateUrl:"view/images/list-and-uploader-update.html",controller:["$scope","PackagesService","ImagesService",function(e,i,t){this.list={},this.listEmpty=!0,this.isListEmpty=function(){return this.listEmpty?!0:!1},t.imageUploaded=function(i){var t=e.imageEditTableCtrl.slidesEdit.length+1,l={path:"/images/upload/",title:i.file.name,newTitle:"",description:"",sequence:t,"new":!0};e.imageEditTableCtrl.slidesEdit.push(l)},t.deleteImageFromUpdateList=function(e){return t.deleteImage(e.id)},this.update=function(){console.log("UPDATING IMAGES!!!!!!!!!!!!!!!"),console.log(e.imageEditTableCtrl.slidesEdit);for(var i=e.imageEditTableCtrl.slidesEdit,l=new Date,s=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate(),a=0;a<i.length;a++){var r=i[a].path+i[a].title,n="";if(i[a].id&&(n=i[a].id),""==n)var d={title:i[a].newTitle,description:i[a].description,path:r,package_id:e.selectedPackage.id,sequence:i[a].sequence,effective_from:s,effective_to:""};else var d={title:i[a].newTitle,description:i[a].description,path:r,package_id:e.selectedPackage.id,sequence:i[a].sequence,effective_from:s,effective_to:"",id:n};t.createImage(d).success(function(){console.log("IMAGE RECORD UPDATED")}).error(function(e){console.log("ERROR WITH IMAGE RECORD UPDATE"),console.log(e)})}}}],controllerAs:"imageListAndUploaderUpdateCtrl"}}).directive("imageUploader",function(){return{restrict:"E",templateUrl:"view/images/uploader.html",controller:["$scope","PackagesService","FileUploader","ImagesService",function(e,i,t,l){e.uploader=new t({url:"index.php/api/v1/image-upload"}),e.uploader.onCompleteItem=function(e,i){e.file.name=i,l.imageUploaded(e)},console.info("uploader",e.uploader)}],controllerAs:"imageUploaderCtrl"}}).directive("ngThumb",["$window",function(e){var i={support:!(!e.FileReader||!e.CanvasRenderingContext2D),isFile:function(i){return angular.isObject(i)&&i instanceof e.File},isImage:function(e){var i="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(i)}};return{restrict:"A",template:"<canvas/>",link:function(e,t,l){function s(e){var i=new Image;i.onload=a,i.src=e.target.result}function a(){var e=r.width||this.width/this.height*r.height,i=r.height||this.height/this.width*r.width;n.attr({width:e,height:i}),n[0].getContext("2d").drawImage(this,0,0,e,i)}if(i.support){var r=e.$eval(l.ngThumb);if(i.isFile(r.file)&&i.isImage(r.file)){var n=t.find("canvas"),d=new FileReader;d.onload=s,d.readAsDataURL(r.file)}}}}}]);
var login=angular.module("app.images-service",[]);login.factory("ImagesService",["$http","$q",function(e,a){var t={};return t._imageList={length:0},t.setImageList=function(e){t._imageList=e},t.getImageList=function(){return t._imageList},t.getAllImages=function(){var a=e({method:"GET",url:"index.php/api/v1/images"});return a},t.getImagesByPackageId=function(a){var t={where:[{package_id:a}]},i=e({method:"GET",url:"index.php/api/v1/images",params:t});return i},t.createImage=function(a){var t=e({method:"POST",url:"index.php/api/v1/images",params:a});return t},t.deleteImage=function(a){var t=e({method:"DELETE",url:"index.php/api/v1/images/"+a});return t},t.updateImageList=function(e){var i=a.defer();return t.getImagesByPackageId(e).success(function(e){t._imageList=e,t.getImageList()&&i.resolve(!0)}),i.promise},t.imageUploaded=function(){},t.isImageListPopulated=function(){return!1},t.deleteImageFromUpdateList=function(){},t}]);
angular.module("app.landing-page",["ui.router"]).config(["$stateProvider",function(n){n.state("landing-page",{url:"/index",views:{"landing-main":{controller:"LandingPageCtrl",templateUrl:"view/landing/main.html"}}})}]).controller("LandingPageCtrl",["$scope",function(){}]);
angular.module("app.main",["ui.router","app.checkout","app.service-categories-services","app.packages-service","app.images-service","app.trims-service"]).config(["$stateProvider",function(e){e.state("main",{url:"/app",views:{"landing-main":{controller:"MainCtrl",templateUrl:"view/main/main.html"}}}).state("main-search-by-category",{url:"/app/search/:category",views:{"landing-main":{controller:"MainSearchByCategoryCtrl",templateUrl:"view/main/main.html"}}}).state("info",{url:"/app/info/:category",views:{"landing-main":{controller:"InfoCtrl",templateUrl:"view/info/main.html"}}}).state("contacts",{"abstract":!0,url:"/app/contacts",resolve:{greeting:function(){return"MAIN"}},controller:["$scope","greeting",function(e,t){this.greeting=t}],controllerAs:"contactsCtrl",templateUrl:"view/main/test.html"}).state("contacts.view",{url:"/view/:id",resolve:{id:["$stateParams",function(e){return e.id}]},controller:["$scope","id",function(e,t){this.id=t}],controllerAs:"contactsViewCtrl",template:"<h1>View {{contactsViewCtrl.id}}</h1>"}).state("contacts.list",{url:"/list",template:"<h1>List</h1>"}).state("contacts.details",{url:"/details",controller:["$scope","PackagesService",function(e){e.contactsCtrl.greeting="Details"}],controllerAs:"contactsDetailCtrl",template:"<h1>Details</h1>"}).state("app",{"abstract":!0,url:"/app2",resolve:{},controller:["$scope",function(){}],controllerAs:"appCtrl",templateUrl:"view/main/main_new.html"}).state("app.packages",{url:"/packages",resolve:{},controller:["$scope",function(){}],controllerAs:"packagesCtrl",templateUrl:"view/packages/controllers/packages.html"}).state("app.packages.all",{url:"/all",resolve:{},controller:["$scope","PackagesService",function(e,t){t.getAllPackages().success(function(a){t.setPackageList(a),e.packagesListCtrl.packages=a,t.setPackageListImages(),t.setPackageListTrims()})}],controllerAs:"packagesAllCtrl",template:'<div class="row"><div class="col-md-10"><packages-list></packages-list></div></div>'}).state("app.packages.category",{url:"/category/:code",resolve:{},controller:["$scope","PackagesService","CategoriesService","$stateParams",function(e,t,a,c){a.getByCode(c.code).success(function(t){a.setSelectedCategory(t.name),e.serviceCategoriesDropDownRouteCtrl.selected=t.name}),t.getPackagesByCode(c.code).success(function(a){t.setPackageList(a),e.packagesListCtrl.packages=a,t.setPackageListImages(),t.setPackageListTrims()})}],controllerAs:"packagesAllCtrl",template:'<div class="row"><div class="col-md-10"><packages-list></packages-list></div></div>'}).state("app.package",{"abstract":!0,url:"/package/:code",resolve:{},controller:["$scope","$stateParams","PackagesService","CategoriesService",function(e,t,a,c){console.log("PACKAGE DEFAULT CTRL"),console.log(t.code),c.getByCode(t.code).success(function(a){c.setSelectedCategory(a.name),e.serviceCategoriesDropDownSideCtrl.selected=a.name,e.serviceCategoriesDropDownSideCtrl.categoryCode=t.code}),a.getPackagesByCode(t.code).success(function(t){a.setPackageList(t),e.packagesListSideCtrl.packages=t,a.setPackageListImages(),a.setPackageListTrims()})}],controllerAs:"packageCtrl",template:'<div class="row"><div class="col-lg-9" ui-view></div> <div class="col-md-3"><service-categories-drop-down-side></service-categories-drop-down-side> <div class="row"><br></div>  <packages-list-side></packages-list-side></div>'}).state("app.package.detail",{url:"/:id",resolve:{},controller:["$scope","PackagesService","CategoriesService","ImagesService","TrimsService","$stateParams",function(e,t,a,c,s,r){this.show=!0,t.getPackageById(r.id).success(function(t){console.log("PACKAGE DETAIL"),console.log(r.id),console.log(r.code),console.log(t),c.updateImageList(r.id).then(function(){var t=c.getImageList();e.imageCarouselCtrl.slides=t,t.length>0&&(e.imageCarouselCtrl.show=!0)}),e.packageDetailsCtrl.package=t,s.updateTrimTable(t.id).then(function(t){console.log(t),console.log("TRIMS IN SERVICE ="),console.log(s.getTableTrims()),e.trimTableCtrl.trims=s.getTableTrims()}),e.selectedPackage=t})}],controllerAs:"packageDetailCtrl",templateUrl:"view/packages/controllers/package-detail.html"}).state("app.package.detail.negotiate",{url:"/negotiate",resolve:{},controller:["$scope","PackagesService","CategoriesService","ImagesService","TrimsService","$stateParams",function(e){e.packageDetailCtrl.show=!1,e.$on("$destroy",function(){e.packageDetailCtrl.show=!0})}],controllerAs:"packageNegotiateCtrl",template:"<initiate-negotiation></initiate-negotiation>"})}]).controller("MainCtrl",["$scope","MarketsService","CategoriesService","PackagesService",function(e,t,a,c){var s={},r={};e._currentMainView="PACKAGES",t.newMarketSelected=function(){s=t.getSelectedMarket()},a.newCategorySelected=function(){r=a.getSelctedCategory(),c.updatePackageList(r)},e.updateMainCurrentView=function(t){e._currentMainView=t},e.getMainCurrentView=function(t){return e._currentMainView==t}}]).controller("MainSearchByCategoryCtrl",["$scope","MarketsService","CategoriesService","PackagesService","$stateParams",function(e,t,a,c,s){var r={},i={};e._currentMainView="PACKAGES",c.updatePackageList=function(t,s){console.log("MAIN CONTROLLER LOGIC CALLED"),a.getByCategoryName_Promise(t).success(s?function(t){c.getPackagesByCategoryAndUserId(t.id,s).success(function(t){e.packagesListCtrl.packages=t,c.setPackageList(t)})}:function(t){c.getPackagesByCategory(t.id).success(function(t){e.packagesListCtrl.packages=t,c.setPackageList(t),c.setPackageListImages(),c.setPackageListTrims()})})},t.newMarketSelected=function(){r=t.getSelectedMarket()},a.newCategorySelected=function(){i=a.getSelctedCategory(),c.updatePackageList(i)},e.updateMainCurrentView=function(t){e._currentMainView=t},e.getMainCurrentView=function(t){return e._currentMainView==t},a.getByCode(s.category).success(function(t){console.log(t),a.setSelectedCategory(t.name),e.serviceCategoriesDropDownCtrl.selected=t.name}).error(function(){console.log("FAILED GETTING CATS")})}]).controller("InfoCtrl",["$scope","$stateParams",function(e,t){e._currentInfoView="DEFAULT",e._currentInfoView=t.category,e.getInfoView=function(t){return e._currentInfoView==t}}]);
angular.module("app.markets",["app.markets-service"]).directive("marketsDropDown",function(){return{restrict:"E",templateUrl:"view/markets/drop-down.html",controller:["$scope","MarketsService",function(e,t){this.selected=t.getSelectedMarket(),this.markets={},t.get().then(function(t){e.marketsDropDownCtrl.markets=t.data}),this.status={isopen:!1},this.changeSelected=function(e){this.selected=e,t.setSelectedMarket(e)}}],controllerAs:"marketsDropDownCtrl"}});
var login=angular.module("app.markets-service",[]);login.factory("MarketsService",["$http",function(e){var t={},r="Dallas/Fort Worth Area";return t.get=function(){var t=e({method:"GET",url:"index.php/api/v1/markets"});return t},t.getCategoryNames=function(){var t={columns:[{0:"name"}]},r=e({method:"GET",url:"index.php/api/v1/markets",params:t});return r},t.getSelectedMarket=function(){return r},t.setSelectedMarket=function(e){r=e,t.newMarketSelected()},t.newMarketSelected=function(){},t}]);
angular.module("app.negotiate-page",["ui.router","app.negotiations-service"]).config(["$stateProvider",function(o){o.state("negotiate-page",{url:"/app/negotiate/sp_response/:initial_id",views:{"landing-main":{controller:["$scope","NegotiationsService","$stateParams",function(o,e,s){this.negotiations=[],this.spResponse="",this.spPrice="",e.getNegotiationsByInitialId(s.initial_id).success(function(e){console.log(e),o.spResponseCtrl.negotiations=e}).error(function(){console.log("FAIL")}),this.submit=function(){console.log("WORKING"),console.log(this.spResponse),console.log(this.spPrice);var s={from_sp:!0,initial_id:this.negotiations[0].initial_id,mail_text:this.spResponse,proposed_price:this.spPrice};console.log("SUBMITTING SP REPSONSE!!"),console.log(s),e.createNegotiation(s).success(function(e){console.log(e),o.spResponseCtrl.negotiations.push(e)}).error(function(){console.log("FAIL")})}}],controllerAs:"spResponseCtrl",templateUrl:"view/negotiate/sp_response.html"}}}).state("negotiate-page-customer",{url:"/app/negotiate/customer_response/:initial_id",views:{"":{controller:["$scope","NegotiationsService","$stateParams",function(o,e,s){this.negotiations=[],this.spResponse="",this.spPrice="",e.getNegotiationsByInitialId(s.initial_id).success(function(e){console.log(e),o.customerResponseCtrl.negotiations=e}).error(function(){console.log("FAIL")}),this.submit=function(){console.log("WORKING"),console.log(this.spResponse),console.log(this.spPrice);var s={from_sp:!1,initial_id:this.negotiations[0].initial_id,mail_text:this.spResponse};console.log("SUBMITTING CUSTOMER REPSONSE!!"),console.log(s),e.createNegotiation(s).success(function(e){console.log(e),o.customerResponseCtrl.negotiations.push(e)}).error(function(){console.log("FAIL")})}}],controllerAs:"customerResponseCtrl",templateUrl:"view/negotiate/customer_response.html"}}})}]);
angular.module("app.negotiation",["app.negotiations-service"]).directive("initiateNegotiation",function(){return{restrict:"E",templateUrl:"view/negotiate/initiate.html",controller:["$scope","NegotiationsService",function(t,e){this.package=t.packageDetailsCtrl.package,this.comment="",this.customerEmailAddress="",this.customerPhoneNumber="",this.successAlert=!1,this.submit=function(){for(var i=0;i<t.companiesNegotiateTableCtrl.companies.length;i++){var o={trim_id:t.companiesNegotiateTableCtrl.companies[i].id,respond_to_email_id:this.customerEmailAddress,respond_to_phone_number:this.customerPhoneNumber,mail_text:this.comment};e.createNegotiation(o).success(function(e){console.log(e),t.initiateNegotiationCtrl.successAlert=!0}).error(function(){})}}}],controllerAs:"initiateNegotiationCtrl"}}).directive("negotiateTrimDropDown",function(){return{restrict:"E",templateUrl:"view/negotiate/trim-drop-down.html",controller:["$scope",function(t){this.selectedTrim="Select Package",this.selectedTrimPrice="",this.showPrice=!1,this.trims=t.companiesNegotiateTableCtrl.companies,console.log("DROP DOWN :"),console.log(this.trims),this.changeSelected=function(e,i,o){t.negotiateTrimDropDownCtrl.selectedTrim=e,t.negotiateTrimDropDownCtrl.selectedTrimPrice=i,t.negotiateTrimDropDownCtrl.selectedTrimId=o,t.negotiateTrimDropDownCtrl.showPrice=!0}}],controllerAs:"negotiateTrimDropDownCtrl"}}).directive("negotiationList",function(){return{restrict:"E",templateUrl:"view/negotiate/list.html",controller:["$scope","NegotiationsService",function(){this.negotiations=[]}],controllerAs:"negotiationListCtrl"}});
var login=angular.module("app.negotiations-service",[]);login.factory("NegotiationsService",["$http",function(i){var t={};return t.getAll=function(){var t=i({method:"GET",url:"index.php/api/v1/negotiations"});return t},t.getSingleById=function(t){var e=i({method:"GET",url:"index.php/api/v1/negotiations/"+t});return e},t.createNegotiation=function(t){var e=i({method:"POST",url:"index.php/api/v1/negotiations",params:t});return e},t.getNegotiationsByInitialId=function(t){var e={where:[{initial_id:t}]},n=i({method:"GET",url:"index.php/api/v1/negotiations",params:e});return n},t.getNegotiationsByRespondEmail=function(t){var e={where:[{respond_to_email_id:t}]},n=i({method:"GET",url:"index.php/api/v1/negotiations",params:e});return n},t.getNegotiationsByTargetEmail=function(t){var e={where:[{target_to_email_id:t}]},n=i({method:"GET",url:"index.php/api/v1/negotiations",params:e});return n},t}]);
var login=angular.module("app.oauth-service",[]);login.factory("OauthService",["$http",function(e){var r={};return r.addToken=function(r,n){var t={user_id:r,token_id:n},a=e({method:"POST",url:"index.php/api/v1/token/add-to-user",params:t});return a},r.getTokenByUserId=function(r){var n=e({method:"GET",url:"index.php/api/v1/token/get-by-user-id/"+r});return n},r}]);
angular.module("app.packages",["app.packages-service","app.users-service","users","textAngular","app.images-service"]).directive("packagesList",function(){return{restrict:"E",templateUrl:"view/packages/list.html",controller:["$scope","PackagesService","CategoriesService","ImagesService",function(e,t,i){this.packages=t.getPackageList(),console.log(this.packages),t.updatePackageList=function(a,s){i.getByCategoryName_Promise(a).success(s?function(i){t.getPackagesByCategoryAndUserId(i.id,s).success(function(i){e.packagesListCtrl.packages=i,t.setPackageList(i)})}:function(i){t.getPackagesByCategory(i.id).success(function(i){e.packagesListCtrl.packages=i,t.setPackageList(i),t.setPackageListImages(),t.setPackageListTrims()})})},this.clicked=function(e){console.log("PACKAGE CLICKED!!!"),console.log(e),t.packageClicked(e)}}],controllerAs:"packagesListCtrl"}}).directive("packagesListAdmin",function(){return{restrict:"E",templateUrl:"view/packages/list-admin.html",controller:["$scope","PackagesService","CategoriesService","ImagesService",function(e,t,i){this.packages=t.getPackageList(),console.log(this.packages),t.updatePackageList=function(a,s){i.getByCategoryName_Promise(a).success(s?function(i){t.getPackagesByCategoryAndUserId(i.id,s).success(function(i){e.packagesListAdminCtrl.packages=i,t.setPackageList(i)})}:function(i){t.getPackagesByCategory(i.id).success(function(i){e.packagesListAdminCtrl.packages=i,t.setPackageList(i),t.setPackageListImages(),t.setPackageListTrims()})})},this.clicked=function(e){console.log("PACKAGE CLICKED!!!"),console.log(e),t.packageClicked(e)}}],controllerAs:"packagesListAdminCtrl"}}).directive("packagesListSide",function(){return{restrict:"E",templateUrl:"view/packages/directives/list-side.html",controller:["$scope","PackagesService","CategoriesService","ImagesService",function(e,t){this.packages=t.getPackageList()}],controllerAs:"packagesListSideCtrl"}}).directive("packageDetails",function(){return{restrict:"E",templateUrl:"view/packages/details.html",controller:["$scope","PackagesService","ImagesService","$state","$timeout",function(e,t,i,a,s){this.negotiatePopover="",this.negotiateClicked=function(){console.log("NEGOTIATE CLICKED"),e.trimTableCtrl.getSelectedTrims().length>0?(this.negotiatePopover="",a.go("app.package.detail.negotiate")):(console.log("TRIM NOT SELECTED"),this.negotiatePopover="Please Select Trim Above",s(function(){e.packageDetailsCtrl.negotiatePopover=""},4e3))}}],controllerAs:"packageDetailsCtrl"}}).directive("packageDetailsAdmin",function(){return{restrict:"E",templateUrl:"view/packages/details-admin.html",controller:["$scope","PackagesService","ImagesService",function(e,t){this.package={},this.fromDate=null,this.toDate=null,this.successAlert=!1,this.fromDateOptions={formatYear:"yy",startingDay:1},this.toDateOptions={formatYear:"yy",startingDay:1},this.openFrom=function(t){t.preventDefault(),t.stopPropagation(),e.packageDetailsAdminCtrl.openedFrom=!0},this.openTo=function(t){console.log(t),t.preventDefault(),t.stopPropagation(),e.packageDetailsAdminCtrl.openedTo=!0},this.formats=["dd-MMMM-yyyy","yyyy-MM-dd","dd.MM.yyyy","shortDate"],this.format=this.formats[1],this.clear=function(){this.fromDate=null},this.hydratePackage=function(t){this.toDate=null,this.fromDate=null,e.packageDetailsAdminCtrl.package=t,console.log("HYDRATE"),console.log(e.packageDetailsAdminCtrl.package),e.inputDescription=t.description,this.fromDate=t.effective_from,"0000-00-00"!=t.effective_to&&(this.toDate=t.effective_to),e.userDD.updateSelectedName(t.user_id)},this.submit=function(){if(this.package.effective_from!=this.fromDate){var i=new Date(this.fromDate);this.package.effective_from=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()}if(this.package.effective_to!=this.toDate){var a=new Date(this.toDate);this.package.effective_to=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}t.createPackage(this.package).success(function(t){console.log(t),e.packageDetailsAdminCtrl.addAlert()})},this.alerts=[],this.addAlert=function(){e.packageDetailsAdminCtrl.alerts.push({type:"success",msg:"Success!  Package updated."})},this.closeAlert=function(t){e.packageDetailsAdminCtrl.alerts.splice(t,1)}}],controllerAs:"packageDetailsAdminCtrl"}}).directive("packageListAndDetails",function(){return{restrict:"E",templateUrl:"view/packages/list-and-details.html",controller:["$scope","PackagesService","ImagesService","TrimsService",function(e,t,i,a){this._currentView="LIST",t.packageClicked=function(t){i.updateImageList(t.id),e.packageDetailsCtrl.package=t,e.packageListAndDetailsCtrl._currentView="PACKAGE",a.updateTrimTable(t.id),e.selectedPackage=t},this.updateCurrentView=function(t){e.imageCarouselCtrl.show=!1,e.packageListAndDetailsCtrl._currentView=t},this.getCurrentView=function(e){return this._currentView==e}}],controllerAs:"packageListAndDetailsCtrl"}}).directive("packageListAndDetailsAdmin",function(){return{restrict:"E",templateUrl:"view/packages/list-and-details-admin.html",controller:["$scope","PackagesService","ImagesService","TrimsService",function(e,t,i,a){this._currentView="LIST",t.packageClicked=function(t){e.packageListAndDetailsAdminCtrl._currentView="PACKAGE",e.updatePackageAdminCtrl.updatePackage(t),e.selectedPackage=t},this.updateCurrentView=function(t){e.packageListAndDetailsAdminCtrl._currentView=t},this.getCurrentView=function(e){return this._currentView==e},this.deleteTrims=function(){for(var t=e.trimTableCtrl.trims,i=[],s=0;s<t.length;s++)t[s].selected?a.deleteTrimById(t[s].id).success(function(){}):i.push(t[s]);e.trimTableCtrl.trims=i}}],controllerAs:"packageListAndDetailsAdminCtrl"}}).directive("packageCrudAdmin",function(){return{restrict:"E",templateUrl:"view/packages/crud-admin.html",controller:["$scope","PackagesService","CategoriesService","MarketsService","UsersService",function(e,t,i,a,s){this._selectedMarket={},this._selectedCategory={},this._selectedUserId=null,this._currentView="MAIN",a.newMarketSelected=function(){this._selectedMarket=a.getSelectedMarket()},i.newCategorySelected=function(){this._selectedCategory=i.getSelctedCategory(),t.updatePackageList(this._selectedCategory,e.packageCrudAdminCtrl._selectedUserId)},s.userDropDownClickedAction=function(a){e.packageCrudAdminCtrl._selectedUserId=a,t.updatePackageList(i.getSelctedCategory(),a)},t.packageListClicked=function(){},this.getCurrentView=function(e){return this._currentView==e},this.setCurrentView=function(e){this._currentView=e}}],controllerAs:"packageCrudAdminCtrl"}}).directive("crudAdminPackageListTile",function(){return{restrict:"E",templateUrl:"view/packages/crud-admin-package-list-tile.html"}}).directive("crudAdminPackageEdit",function(){return{restrict:"E",templateUrl:"view/packages/crud-admin-package-edit-tile.html",controller:["$scope","PackagesService","CategoriesService","MarketsService","ImagesService",function(e,t,i,a,s){this.categoryId="",this.code="",this.name="",this.summary="",this.description="",this.sequence="",e.fromDate=null,e.toDate=null,this.successAlert=!1,this.fromDateOptions={formatYear:"yy",startingDay:1},this.toDateOptions={formatYear:"yy",startingDay:1},e.openFrom=function(t){t.preventDefault(),t.stopPropagation(),e.openedFrom=!0},e.openTo=function(t){console.log(t),t.preventDefault(),t.stopPropagation(),e.openedTo=!0},this.formats=["dd-MMMM-yyyy","yyyy-MM-dd","dd.MM.yyyy","shortDate"],this.format=this.formats[1],this.clear=function(){this.fromDate=null},this.submit=function(){var i={user_id:e.userDD.user_id,category_id:e.serviceCategoriesDropDownForInsertCtrl.selectedId,code:this.code,name:this.name,summary:this.summary,description:e.inputDescription,effective_from:e.fromDate,effective_to:e.toDate,sequence:this.sequence};t.createPackage(i).success(function(t){console.log("SUCCESS!!"),console.log(t),e.crudAdminPackageEdit.successAlert=!0;for(var i=e.imageEditTableCtrl.slidesEdit.length,a=0;i>a;a++){var r=e.imageEditTableCtrl.slidesEdit[a],c=r.path+r.title,o={title:r.newTitle,description:r.description,path:c,package_id:t.id,sequence:r.sequence,effective_from:t.effective_from,effective_to:t.effective_to};s.createImage(o).success(function(){console.log("IMAGE CREATED")}).error(function(){console.log("IMAGE FAILED")})}e.crudAdminPackageEdit.categoryId="",e.crudAdminPackageEdit.code="",e.crudAdminPackageEdit.name="",e.crudAdminPackageEdit.summary="",e.crudAdminPackageEdit.description="",e.crudAdminPackageEdit.sequence="",e.userDD.user_id="",e.$scope.serviceCategoriesDropDownForInsertCtrl.selectedId=""}).error(function(){console.log("ERROR")})}}],controllerAs:"crudAdminPackageEdit"}}).directive("crudCustomerPackageEdit",function(){return{restrict:"E",templateUrl:"view/packages/crud-customer-package-edit.html",controller:["$scope","PackagesService","CategoriesService","MarketsService","ImagesService",function(e,t,i,a,s){this.userId=9999,this.categoryId=9999,this.name="",this.description="",e.fromDate=null,e.toDate=null,this.successAlert=!1,this.fromDateOptions={formatYear:"yy",startingDay:1},this.toDateOptions={formatYear:"yy",startingDay:1},e.openFrom=function(t){t.preventDefault(),t.stopPropagation(),e.openedFrom=!0},e.openTo=function(t){console.log(t),t.preventDefault(),t.stopPropagation(),e.openedTo=!0},this.formats=["dd-MMMM-yyyy","yyyy-MM-dd","dd.MM.yyyy","shortDate"],this.format=this.formats[1],this.clear=function(){this.fromDate=null},this.submit=function(){var i={user_id:this.userId,category_id:this.categoryId,name:this.name,summary:"",description:this.description,effective_from:"",effective_to:"",sequence:1};t.createPackage(i).success(function(t){console.log("SUCCESS!!"),console.log(t),e.crudCustomerPackageEditCtrl.successAlert=!0;for(var i=e.imageEditTableCtrl.slidesEdit.length,a=0;i>a;a++){var r=e.imageEditTableCtrl.slidesEdit[a],c=r.path+r.title;console.log(r);var o={title:r.newTitle,description:r.description,path:c,package_id:t.id,sequence:r.sequence,effective_from:t.effective_from,effective_to:t.effective_to};console.log(o),s.createImage(o).success(function(){console.log("IMAGE CREATED")}).error(function(){console.log("IMAGE FAILED")})}}).error(function(){console.log("ERROR")})}}],controllerAs:"crudCustomerPackageEditCtrl"}}).directive("updatePackageAdmin",function(){return{restrict:"E",templateUrl:"view/packages/update-admin.html",controller:["$scope","PackagesService","CategoriesService","MarketsService","TrimsService","ImagesService",function(e,t,i,a,s,r){this._currentUpdatePackageView="DETAILS",this.getCurrentView=function(e){return this._currentUpdatePackageView==e},this.setCurrentView=function(e){this._currentUpdatePackageView=e},this.updatePackage=function(t){e.imageEditTableCtrl.slidesEdit=[],s.updateTrimTable(t.id).then(function(t){console.log(t),console.log("TRIMS IN SERVICE ="),console.log(s.getTableTrims()),e.trimTableCtrl.trims=s.getTableTrims()}),e.packageDetailsAdminCtrl.hydratePackage(t),r.updateImageList(t.id),e.serviceCategoriesDropDownForUpdateCtrl.updateSelectedById(t.category_id),r.getImagesByPackageId(t.id).success(function(t){console.log("UPDATE PACKAGE LIST");for(var i=0;i<t.length;i++){console.log(t[i].path.substring(0,15)),console.log(t[i].path.substring(15));var a={path:"/images/upload/",title:t[i].path.substring(15),newTitle:t[i].title,description:t[i].description,sequence:t[i].sequence,id:t[i].id,fromDb:!0};e.imageEditTableCtrl.slidesEdit.push(a)}e.imageEditTableCtrl.sortImageList()}).error(function(){})}}],controllerAs:"updatePackageAdminCtrl"}}).directive("updateTrimsAdmin",function(){return{restrict:"E",templateUrl:"view/packages/update-trims-admin.html",controller:["$scope","TrimsService","ImagesService",function(){}],controllerAs:"updateTrimsAdminCtrl"}});
var login=angular.module("app.packages-service",["app.images-service","app.trims-service"]);login.factory("PackagesService",["$http","CategoriesService","ImagesService","TrimsService",function(e,a,r,t){var i={},n={};return i.setPackageList=function(e){n=e},i.getPackageList=function(){return n},i.setImagesForPackageListById=function(e,a){for(var r=0;r<n.length;r++)n[r].id==e&&(n[r].images=a)},i.setHeadLineImageForPackageListById=function(e,a){for(var r=0;r<n.length;r++)n[r].id==e&&(n[r].headImage=a[0])},i.setPackageListImages=function(){function e(e){var a=e;r.getImagesByPackageId(a).success(function(e){i.setHeadLineImageForPackageListById(a,e)}).error(function(){})}for(var a=0;a<n.length;a++)e(n[a].id);console.log("PACKAGE WITH IMAGES"),console.log(i.getPackageList())},i.setHeadLineTrimForPackageListById=function(e,a){for(var r=0;r<n.length;r++)n[r].id==e&&(n[r].headTrim=a[0])},i.setPackageListTrims=function(){function e(e){var a=e;t.getAllByPackageId(a).success(function(e){i.setHeadLineTrimForPackageListById(a,e)}).error(function(){})}for(var a=0;a<n.length;a++)e(n[a].id);console.log("PACKAGE WITH TRIMS"),console.log(i.getPackageList())},i.getAllPackages=function(){var a=e({method:"GET",url:"index.php/api/v1/packages"});return a},i.getPackagesByCategory=function(a){var r={where:[{category_id:a}]},t=e({method:"GET",url:"index.php/api/v1/packages",params:r});return t},i.getPackagesByCode=function(a){var r={where:[{code:a}]},t=e({method:"GET",url:"index.php/api/v1/packages",params:r});return t},i.getPackagesByCategoryAndUserId=function(a,r){var t={where:[{category_id:a,user_id:r}]},i=e({method:"GET",url:"index.php/api/v1/packages",params:t});return i},i.getPackageById=function(a){var r=e({method:"GET",url:"index.php/api/v1/packages/"+a});return r},i.createPackage=function(a){var r=e({method:"POST",url:"index.php/api/v1/packages",params:a});return r},i.updatePackageList=function(){console.log("DEFAULT LOGIC CALLED")},i.packageClicked=function(){},i}]);
angular.module("app.service-categories",["app.service-categories-services"]).directive("serviceCategoriesDropDown",function(){return{restrict:"E",templateUrl:"view/service-categories/drop-down.html",controller:["$scope","CategoriesService",function(e,t){this.selected=t.getSelctedCategory(),this.categories={},t.getCategoryNames().then(function(t){e.serviceCategoriesDropDownCtrl.categories=t.data}),this.status={isopen:!1},this.changeSelected=function(e){this.selected=e,t.setSelectedCategory(e)}}],controllerAs:"serviceCategoriesDropDownCtrl"}}).directive("serviceCategoriesDropDownRoute",function(){return{restrict:"E",templateUrl:"view/service-categories/drop-down-route.html",controller:["$scope","CategoriesService",function(e,t){this.selected=t.getSelctedCategory(),this.categories={},t.get().then(function(t){e.serviceCategoriesDropDownRouteCtrl.categories=t.data,console.log(e.serviceCategoriesDropDownRouteCtrl.categories)}),this.status={isopen:!1},this.changeSelected=function(e){this.selected=e,t.setSelectedCategory(e)}}],controllerAs:"serviceCategoriesDropDownRouteCtrl"}}).directive("serviceCategoriesDropDownSide",function(){return{restrict:"E",templateUrl:"view/service-categories/drop-down-side.html",controller:["$scope","CategoriesService","PackagesService",function(e,t,o){this.selected=t.getSelctedCategory(),this.categories={},this.categoryCode={},t.get().then(function(t){e.serviceCategoriesDropDownSideCtrl.categories=t.data,console.log(e.serviceCategoriesDropDownSideCtrl.categories)}),this.status={isopen:!1},this.changeSelected=function(r,s){console.log(s),this.selected=r,t.setSelectedCategory(r),this.categoryCode=s,o.getPackagesByCode(this.categoryCode).success(function(t){o.setPackageList(t),e.packagesListSideCtrl.packages=t,o.setPackageListImages(),o.setPackageListTrims()})}}],controllerAs:"serviceCategoriesDropDownSideCtrl"}}).directive("serviceCategoriesDropDownForInsert",function(){return{restrict:"E",templateUrl:"view/service-categories/drop-down-insert.html",controller:["$scope","CategoriesService",function(e,t){this.selectedName="Select",this.selectedId="",this.categories={},t.get().then(function(t){e.serviceCategoriesDropDownForInsertCtrl.categories=t.data,console.log("CATS"),console.log(t.data)}),this.status={isopen:!1},this.changeSelected=function(t){console.log("NEW SELECT : "),console.log(t),e.serviceCategoriesDropDownForInsertCtrl.selectedName=t.name,e.serviceCategoriesDropDownForInsertCtrl.selectedId=t.id}}],controllerAs:"serviceCategoriesDropDownForInsertCtrl"}}).directive("serviceCategoriesDropDownForUpdate",function(){return{restrict:"E",templateUrl:"view/service-categories/drop-down-update.html",controller:["$scope","CategoriesService",function(e,t){this.selectedName="Select",this.selectedId="",this.categories={},t.get().then(function(t){e.serviceCategoriesDropDownForUpdateCtrl.categories=t.data,console.log("CATS"),console.log(t.data)}),this.status={isopen:!1},this.changeSelected=function(t){console.log("NEW SELECT : "),console.log(t),e.serviceCategoriesDropDownForUpdateCtrl.selectedName=t.name,e.serviceCategoriesDropDownForUpdateCtrl.selectedId=t.id},this.updateSelectedById=function(t){for(var o=0;o<this.categories.length;o++)if(this.categories[o].id==t)return e.serviceCategoriesDropDownForUpdateCtrl.selectedId=t,void(e.serviceCategoriesDropDownForUpdateCtrl.selectedName=this.categories[o].name)}}],controllerAs:"serviceCategoriesDropDownForUpdateCtrl"}});
var login=angular.module("app.service-categories-services",[]);login.factory("CategoriesService",["$http",function(e){var r={},t="Select Category";return r.get=function(){var r=e({method:"GET",url:"index.php/api/v1/service-categories"});return r},r.getByCode=function(r){var t={where:[{code:r}]},a=e({method:"GET",url:"index.php/api/v1/service-categories",params:t});return a},r.getCategoryNames=function(){var r={columns:[{0:"name"}]},t=e({method:"GET",url:"index.php/api/v1/service-categories",params:r});return t},r.getSelctedCategory=function(){return t},r.getByCategoryName_Promise=function(r){var t=e({method:"GET",url:"index.php/api/v1/service-categories/"+r});return t},r.setSelectedCategory=function(e){t=e,r.newCategorySelected()},r.newCategorySelected=function(){},r}]);
!function(){var e=angular.module("privileges",["restangular"]);e.directive("privilegeModule",function(){return{restrict:"E",templateUrl:"view/privileges/module-3.html",controller:["$scope","Restangular","$http",function(e,l,r){var t=this;t.privileges={},t.privilegeModules={},t.types={},r({method:"GET",url:"index.php/api/v1/modules/",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{}}).then(function(l){t.privilegeModules=l.data,console.log(e)}),t.onTabSelected=function(){console.log("SELECTED")},t.updatePrivileges=function(e){console.log("HERE"),console.log(e)}}],controllerAs:"privilegesController"}}),e.directive("userDropDown2",function(){return{restrict:"E",templateUrl:"view/users/users-drop-down-tile.html",controller:["$scope","Restangular",function(e,l){var r=this;r.user_name="Select a User",r.data=[],l.setBaseUrl("index.php/api/v1");var t=l.all("users");t.getList().then(function(e){console.log(e),r.data=e}),this.click=function(l,t){e.privilegesController.updatePrivileges(l),r.user_name=t}}],controllerAs:"userDD"}})}();
!function(){var e=angular.module("privileges",["restangular"]);e.directive("privilegeModule",function(){return{restrict:"E",templateUrl:"view/privileges/module.html",controller:["$scope","Restangular","$http",function(e,i,l){var s=this;e.privileges={},e.selectedIndex=0,s.checkedPrivileges={},e.availablePrivileges=[],s.userId=0,s.switchOne=!0,s.switchTwo=!1,s.switchThree=!0,s.switchFour=!1,s.switchFive=!0,s.switches={name:function(e){return console.log(e),1==e.id?(console.log("RETURNING SWITCH ONE"),s.switchOne):2==e.id?(console.log("RETURNING SWITCH TWO"),s.switchTwo):3==e.id?(console.log("RETURNING SWITCH THREE"),s.switchThree):4==e.id?(console.log("RETURNING SWITCH FOUR"),s.switchFour):5==e.id?(console.log("RETURNING SWITCH FIVE"),s.switchFive):void 0}},s.switches2={name:function(e,i){console.log(e),console.log(i)}},i.setBaseUrl("index.php/api/v1");var t=i.all("privileges");t.getList().then(function(l){e.privileges=i.stripRestangular(l);for(var t=0;t<e.privileges.length;t++)0==t?(e.privileges[t].active="true",s.types=e.privileges[t].types):e.privileges[t].active="false";console.log(s.types),console.log(e)}),e.switchBinding=function(i){return console.log(i),1==i.id?e.switchOne:2==i.id?e.switchTwo:3==i.id?e.switchThree:4==i.id?e.switchFour:5==i.id?e.switchFive:void 0},this.onTabSelected=function(i){typesSize=0;for(var l in i.types)typesSize++;for(var t=1;typesSize>=t;t++){i.types[t].available=!1;for(var r=0;r<e.availablePrivileges.length;r++)if(e.availablePrivileges[r].module==i.id&&e.availablePrivileges[r].privilegeType==l){i.types[t].available=!0;break}}s.types=i.types},this.updatePrivileges=function(l){i.setBaseUrl("index.php/api/v1"),s.userId=l;var t=i.one("users",l).all("privileges");t.getList().then(function(l){var s=i.stripRestangular(l);e.availablePrivileges=[];for(var t=0;t<s.length;t++)if(s[t].id)for(var r=0;r<s[t].types.length;r++)if(s[t].id&&s[t].types[r].id){var a={module:s[t].id,privilegeType:s[t].types[r].id};e.availablePrivileges.push(a)}})},this.addPrivilege=function(e,i){l({method:"PUT",url:"index.php/api/v1/users/"+s.userId+"/modules/"+e+"/privileges/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{}}).then(function(){s.updatePrivileges(s.userId)})},this.removePrivilege=function(e,i){l({method:"delete",url:"index.php/api/v1/users/"+s.userId+"/modules/"+e+"/privileges/"+i,params:{action:"delete"},data:{}}).then(function(){s.updatePrivileges(s.userId)})},this.checkPrivilege2=function(e,i){for(var l=!1,t=0;t<s.availablePrivileges.length;t++)s.availablePrivileges[t].module==e&&s.availablePrivileges[t].privilegeType==i&&(l=!0);return l?void 0:{"background-color":"#CACCCC"}},this.showPrivileges=function(){return s.availablePrivileges.length?!0:!1}}],controllerAs:"main"}}),e.directive("userDropDown2",function(){return{restrict:"E",templateUrl:"view/users/users-drop-down-tile.html",controller:["$scope","Restangular",function(e,i){var l=this;l.user_name="Select a User",l.data=[],i.setBaseUrl("index.php/api/v1");var s=i.all("users");s.getList().then(function(e){l.data=e}),this.click=function(i,s){e.main.updatePrivileges(i),l.user_name=s}}],controllerAs:"userDD"}})}();
angular.module("app.trims",["app.trims-service"]).directive("trimTable",function(){return{restrict:"E",templateUrl:"view/trims/table.html",controller:["$scope","TrimsService","CompaniesService",function(t,e){this.trims=e.getTableTrims(),this.getSelectedTrim=function(){for(var e=0;e<t.trimTableCtrl.trims.length;e++)if(t.trimTableCtrl.trims[e].selected)return t.trimTableCtrl.trims[e]},this.getSelectedTrims=function(){for(var e=[],r=0;r<t.trimTableCtrl.trims.length;r++)t.trimTableCtrl.trims[r].selected&&e.push(t.trimTableCtrl.trims[r]);return e}}],controllerAs:"trimTableCtrl"}}).directive("addTrimAdmin",function(){return{restrict:"E",templateUrl:"view/trims/add-trim-admin.html",controller:["$scope","TrimsService","CompaniesService",function(t,e,r){this.marketId=1,this.name="",this.price="",this.currency="$",this.comment="",this.successAlert=!1,t.fromDate=null,t.toDate=null,this.successAlert=!1,this.fromDateOptions={formatYear:"yy",startingDay:1},this.toDateOptions={formatYear:"yy",startingDay:1},t.openFrom=function(e){e.preventDefault(),e.stopPropagation(),t.openedFrom=!0},t.openTo=function(e){console.log(e),e.preventDefault(),e.stopPropagation(),t.openedTo=!0},this.formats=["dd-MMMM-yyyy","yyyy-MM-dd","dd.MM.yyyy","shortDate"],this.format=this.formats[1],this.clear=function(){this.fromDate=null},this.submit=function(i){console.log("SUBMITTING TRIM"),console.log(i);var s={name:this.name,comment:this.comment,price:this.price,currency:this.currency,user_id:t.userDD.user_id,package_id:t.packageDetailsAdminCtrl.package.id,sequence:1,market_id:this.marketId,effective_from:t.fromDate,effective_to:t.toDate};e.createTrim(s).success(function(e){var i=e;r.getAllByPrimaryUserId(i.user_id).success(function(e){console.log(e),i.service_provider=e[0].name,console.log(i),t.trimTableCtrl.trims.push(i),t.addTrimAdminCtrl.successAlert=!0,console.log("SUCCESS!!!")})}).error(function(){console.log("ERROR UPLOADING TRIM")})}}],controllerAs:"addTrimAdminCtrl"}});
var login=angular.module("app.trims-service",["app.companies-service"]);login.factory("TrimsService",["$http","$q","CompaniesService",function(e,r,i){var t={};return t.tableTrims=[],t.getAllTrims=function(){var r=e({method:"GET",url:"index.php/api/v1/trims"});return r},t.getAllByPackageId=function(r){var i={where:[{package_id:r}]},t=e({method:"GET",url:"index.php/api/v1/trims",params:i});return t},t.createTrim=function(r){var i=e({method:"POST",url:"index.php/api/v1/trims",params:r});return i},t.deleteTrimById=function(r){var i=e({method:"DELETE",url:"index.php/api/v1/trims/"+r});return i},t.getTableTrims=function(){return t.tableTrims},t.updateTrimServiceProvider=function(e,r){for(var i=0;i<t.tableTrims.length;i++)t.tableTrims[i].user_id==e&&(t.tableTrims[i].service_provider=r.name,t.tableTrims[i].company_id=r.id)},t.updateTrimTable=function(e){var a=r.defer();return console.log("UPDATING TRIM TABLE"),t.getAllByPackageId(e).success(function(e){t.tableTrims=e;for(var r=e,n=0;n<r.length;n++)i.getAllByPrimaryUserId(r[n].user_id).success(function(e){t.updateTrimServiceProvider(e[0].primary_user_id,e[0])});t.getTableTrims()?a.resolve("TRIMS UPDATED"):a.reject("TRIMS FAILED")}),a.promise},t}]);
var login=angular.module("app.users-service",[]);login.factory("UsersService",["$http",function(r){var e={};return e.getAllUsers=function(){var e=r({method:"GET",url:"index.php/api/v1/users"});return e},e.createNewUserCustomer=function(e){var n=r({method:"POST",url:"index.php/api/v1/users-customer",params:e});return n},e.userDropDownClickedAction=function(){},e}]);
!function(){var e=angular.module("users",["restangular","app.users-service"]);e.directive("userDropDown",function(){return{restrict:"E",templateUrl:"view/users/users-drop-down-tile.html",controller:["$scope","Restangular","UsersService",function(e,r,t){var s=this;s.user_name="Select User",s.data=[],r.setBaseUrl("index.php/api/v1");var n=r.all("users");n.getList().then(function(e){s.data=e,console.log(s)}),s.click=function(r,s){console.log("USER CLICKED!! YOLO"),e.userDropDownCtrl.user_name=s,t.userDropDownClickedAction(r)}}],controllerAs:"userDropDownCtrl"}}),e.directive("userDropDownInput",function(){return{restrict:"E",templateUrl:"view/users/users-drop-down-input.html",controller:["$scope","Restangular",function(e,r){var t=this;t.user_name="Select User",t.user_id="",t.data=[],r.setBaseUrl("index.php/api/v1");var s=r.all("users");s.getList().then(function(e){t.data=e,console.log(t)}),this.click=function(r,t){e.userDD.user_name=t,e.userDD.user_id=r},this.updateSelectedName=function(e){console.log("USERS ="),console.log(t.data),t.user_id=e;for(var r=0;r<t.data.length;r++)if(t.data[r].user_id==e)return void(t.user_name=t.data[r].name)}}],controllerAs:"userDD"}})}();
angular.module("app.manage-customer",["ui.router","app.login","app.negotiations-service"]).config(["$stateProvider",function(o){o.state("customer",{url:"/manage/customer",views:{"manage-main":{controller:"MainCustomerCtrl",templateUrl:"view/manage/customer/main.html"},"manage-login":{controller:"LoginCtrl",templateUrl:"view/manage/login/main.html"}}}).state("customer.packages",{url:"/packages",resolve:{},controller:["$scope","PackagesService",function(){}],controllerAs:"customerPackagesCtrl",template:"<h1>PACKAGES</h1>"}).state("customer.negotiations",{url:"/negotiations",resolve:{},controller:["$scope","NegotiationsService",function(){console.log("CUSTOMER NEGOTIATION CTRL")}],controllerAs:"customerNegotiationsCtrl",templateUrl:"view/negotiate/controllers/customer-negotiations.html"}).state("customer.negotiations.received",{url:"/received",resolve:{},controller:["$scope","NegotiationsService",function(o,e){console.log("CUSTOMER NEGOTIATION RECEIVED CTRL"),console.log(sessionStorage.userId),this.negotiations=[],e.getNegotiationsByTargetEmail(sessionStorage.userId).success(function(e){console.log(e),o.customerNegotiationsSentCtrl.negotiations=e}).error(function(o){console.log("FAIL"),console.log(o)})}],controllerAs:"customerNegotiationsSentCtrl",templateUrl:"view/negotiate/controllers/customer-negotiations-sent.html"}).state("customer.negotiations.sent",{url:"/sent",resolve:{},controller:["$scope","NegotiationsService",function(o,e){console.log("CUSTOMER NEGOTIATION SENT CTRL"),console.log(sessionStorage.userId),this.negotiations=[],e.getNegotiationsByRespondEmail(sessionStorage.userId).success(function(e){console.log(e),o.customerNegotiationsSentCtrl.negotiations=e}).error(function(o){console.log("FAIL"),console.log(o)})}],controllerAs:"customerNegotiationsSentCtrl",templateUrl:"view/negotiate/controllers/customer-negotiations-sent.html"}).state("customer.negotiations.respond",{url:"/respond/:initial_id",resolve:{},controller:["$scope","NegotiationsService","$stateParams",function(o,e,t){this.negotiations=[],this.spResponse="",this.spPrice="",e.getNegotiationsByInitialId(t.initial_id).success(function(e){console.log(e),o.customerResponseCtrl.negotiations=e}).error(function(){console.log("FAIL")}),this.submit=function(){console.log("WORKING"),console.log(this.spResponse),console.log(this.spPrice);var t={from_sp:!1,initial_id:this.negotiations[0].initial_id,mail_text:this.spResponse};console.log("SUBMITTING CUSTOMER REPSONSE!!"),console.log(t),e.createNegotiation(t).success(function(e){console.log(e),o.customerResponseCtrl.negotiations.push(e)}).error(function(){console.log("FAIL")})}}],controllerAs:"customerResponseCtrl",templateUrl:"view/negotiate/controllers/customer-response-admin.html"})}]).controller("MainCustomerCtrl",["$scope",function(){if(sessionStorage.newUserCategory="customer","true"==sessionStorage.loggedIn&&("customer"!=sessionStorage.userCategory||"CUSTOMER"!=sessionStorage.userCategory))switch(sessionStorage.userCategory){case"company":window.location="#/manage/admin";break;case"service_provider":window.location="#/manage/service-provider";break;case"customer":window.location="#/manage/customer";break;case"CUSTOMER":window.location="#/manage/customer";break;default:window.location="#/index"}}]);
angular.module("app.manage-admin",["ui.router","app.login"]).config(["$stateProvider",function(e){e.state("admin",{url:"/manage/admin",views:{"manage-main":{controller:"MainAdminCtrl",templateUrl:"view/manage/admin/main.html"},"manage-login":{controller:"LoginCtrl",templateUrl:"view/manage/login/main.html"}}})}]).controller("MainAdminCtrl",["$scope","$http",function(e,n){if(n({method:"GET",url:"index.php/api/v1/login/get-logged-in"}).success(function(e){console.log("AUTH USER :"),console.log(e)}).error(function(){console.log("AUTH USER FAIL")}),sessionStorage.newUserCategory="company","true"==sessionStorage.loggedIn&&"company"!=sessionStorage.userCategory)switch(sessionStorage.userCategory){case"company":window.location="#/manage/admin";break;case"service_provider":window.location="#/manage/service-provider";break;case"customer":window.location="#/manage/customer";break;case"CUSTOMER":window.location="#/manage/customer";break;default:window.location="#/index"}this.currentView="Main"}]);
var login=angular.module("AuthSrvc",[]);login.factory("Login",["$http",function(n){return{auth:function(r){var t=n({method:"POST",url:"index.php/api/v1/login/auth",params:r});return t}}}]);
angular.module("app.login",["app.new-user"]).controller("LoginCtrl",["$scope","$http","Login",function(e,o,n){e.email="",e.password="",e.panelSelected=1,e.showNewUserPanel=!0,e.alert=!1,e.newUserAlert=!1,e.loginAlerts=[],e.clickTest=function(){console.log("CLICKED")},e.addLoginAlert=function(o){switch(o){case"LOGIN_FAIL":e.loginAlerts.push({type:"danger",strong:"Warning!  ",msg:"That user and password combo is incorrect."});break;case"NEW_USER_SUCCESS":e.loginAlerts.push({type:"success",strong:"Success!  ",msg:"You are ready to login now."})}},e.addCustomLoginAlert=function(o,n){switch(o){case"ERROR":e.loginAlerts.push({type:"danger",strong:"Error!  ",msg:n})}},e.closeLoginAlert=function(o){e.loginAlerts.splice(o,1)},e.submit=function(o){console.log("LOGIN FORM EXECUTED!!!"),e.email=o.target[0].value,e.password=o.target[1].value,console.log(e.email);var s=(e.email,{email:e.email,password:e.password});n.auth(s).success(function(o){if("FALSE"!=o)switch(sessionStorage.userId=e.email,sessionStorage.userCategory=o,sessionStorage.loggedIn=!0,e.$parent.$parent.loggedIn=!0,sessionStorage.userCategory){case"company":window.location="#/manage/admin",location.reload();break;case"service_provider":window.location="#/manage/service-provider",location.reload();break;case"customer":window.location="#/manage/customer",location.reload();break;case"CUSTOMER":window.location="#/manage/customer",location.reload();break;default:window.location="#/index"}else e.addLoginAlert("LOGIN_FAIL")}).error(function(){e.addLoginAlert("LOGIN_FAIL")})},e.isSelected=function(o){return e.panelSelected===o},e.selectPanel=function(o){e.panelSelected=o,e.loginAlerts=[]},"ADMIN"===sessionStorage.userCategory&&(e.showNewUserPanel=!1)}]);
angular.module("app.nav-bar",[]).directive("navBarManage",function(){return{restrict:"E",templateUrl:"view/manage/navigation/nav-bar-manage.html",controller:["$scope",function(r){r.logOff=function(){console.log("LOGGING OFF"),sessionStorage.clear(),location.reload()}}],controllerAs:"navBarCtrl"}}).directive("navBarManageCustomer",function(){return{restrict:"E",templateUrl:"view/manage/navigation/nav-bar-manage-customer.html",controller:["$scope",function(r){r.logOff=function(){console.log("LOGGING OFF"),sessionStorage.clear(),location.reload()}}],controllerAs:"navBarCtrl"}}).directive("navBarServiceProvider",function(){return{restrict:"E",templateUrl:"view/manage/navigation/nav-bar-service-provider.html",controller:["$scope",function(r){r.logOff=function(){console.log("LOGGING OFF"),sessionStorage.clear(),location.reload()}}],controllerAs:"navBarCtrl"}}).directive("navBarLogin",function(){return{restrict:"E",templateUrl:"view/manage/navigation/nav-bar-login.html",controller:["$scope",function(){}],controllerAs:"navBarCtrl"}}).directive("navBar",function(){return{restrict:"E",templateUrl:"view/manage/navigation/nav-bar.html",controller:["$scope",function(){}],controllerAs:"navBarCtrl"}}).directive("navBar2",function(){return{restrict:"E",templateUrl:"view/manage/navigation/nav-bar-2.html",controller:["$scope",function(){}],controllerAs:"navBar2Ctrl"}}).directive("topNav",function(){return{restrict:"E",templateUrl:"view/manage/navigation/top-nav.html",controller:["$scope",function(){}],controllerAs:"topNavCtrl"}});
angular.module("app.new-user-customer",["app.users-service"]).directive("newUserCustomerForm",function(){return{restrict:"E",templateUrl:"view/manage/new-user/customer.html",controller:["$scope","UsersService",function(e,r){this.email="",this.password="",this.zipCode="",this.submit=function(){var s={email:this.email,password:this.password,zip_code:this.zipCode};r.createNewUserCustomer(s).success(function(){e.addLoginAlert("NEW_USER_SUCCESS")}).error(function(r){e.addCustomLoginAlert("ERROR",r)})}}],controllerAs:"newUserCustomerCtrl"}});
angular.module("app.new-user",["app.new-user-service-provider","app.new-user-customer"]).directive("newUserForm",function(){return{restrict:"E",templateUrl:"view/manage/new-user/main.html",controller:["$scope",function(e){e.category=sessionStorage.newUserCategory,e.isCategory=function(r){return e.category===r},e.newUserSuccess=function(){e.alert2=!0}}],controllerAs:"newUserMainCtrl"}});
angular.module("app.new-user-service-provider",[]).directive("newUserServiceProviderForm",function(){return{restrict:"E",templateUrl:"view/manage/new-user/service-provider.html",controller:["$scope",function(e){e.alert2=!1}],controllerAs:"newUserServiceProviderCtrl"}});
angular.module("app.manage-service-provider",["ui.router","app.login","app.oauth-service"]).config(["$stateProvider",function(e){e.state("service-provider",{url:"/manage/service-provider",views:{"manage-main":{controller:"MainSPCtrl",templateUrl:"view/manage/service-provider/main.html"},"manage-login":{controller:"LoginCtrl",templateUrl:"view/manage/login/main.html"}}}),e.state("service-provider-oauth",{url:"/manage/service-provider/oauth/:token",views:{"manage-main":{controller:"OauthCtrl",templateUrl:"view/manage/service-provider/oauth.html"}}})}]).controller("MainSPCtrl",["$scope","$http",function(e){if(sessionStorage.newUserCategory="service_provider","true"==sessionStorage.loggedIn&&"service_provider"!=sessionStorage.userCategory)switch(sessionStorage.userCategory){case"company":window.location="#/manage/admin";break;case"service_provider":window.location="#/manage/service-provider";break;case"customer":window.location="#/manage/customer";break;case"CUSTOMER":window.location="#/manage/customer";break;default:window.location="#/index"}e._currentManageView="PACKAGES",e.updateManageCurrentView=function(o){e._currentManageView=o},e.getManageCurrentView=function(o){return e._currentManageView==o}}]).controller("OauthCtrl",["$scope","OauthService","$http","$stateParams",function(e,o,r,a){console.log("POST"),console.log(a.token),o.addToken(sessionStorage.userId,a.token).success(function(e){console.log("TOKEN SUCCESS"),console.log(e)}).error(function(e){console.log("TOKEN ERROR"),console.log(e)})}]);